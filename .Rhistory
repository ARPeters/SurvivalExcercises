ThetaFunction<- function(p, n, se, sp){
ThetaHat_Corrected=(((p/n)-(1-sp))/(se+sp-1))
ThetaHat_Corrected<- ifelse(ThetaHat_Corrected>1, 1, ThetaHat_Corrected)
ThetaHat_Corrected<- ifelse(ThetaHat_Corrected<0, 0, ThetaHat_Corrected)
ThetaHat_Corrected
}
testn<-100
testp<-20
testse<-0.9
testsp<-0.9
testtheta<-ThetaFunction(testp, testn, testse, testsp)
testtheta
ds<-read.csv("S:/CCAN/CCANResEval/Title IV-E Waiver/DHS Data/kahd_72152_FY2012-FY2013/derived/joins_for_sas/aocs_client_removed-2014-11-16a.csv")
t<-c(1, 3, 5, NA, "Rats")
is.na(t)
q<-toString(t)
q
length(q)
q<-toString(t[2])
q
q<-as.string(t[2])
q<-as.char(t[2])
q<-as.character(t[2])
q
q<-as.character(t)
q
NAhilator<-function(x){
for(i in 1:ncol(x)){
x[,i]<-as.character(x[,i])
for(j in 1:row(x)){
if(is.na(x[j,i])==TRUE){
x[j,i]<-c(".")
}
}
}
}
ds2<-NAhilator(ds)
warnings()
NAhilator<-function(x){
for(i in 1:ncol(x)){
x[,i]<-as.character(x[,i])
for(j in 1:row(x)){
if(is.na(x[j,i])==TRUE){
x[j,i]<-c(".")
}
}
}
return head(x)
}
NAhilator<-function(x){
for(i in 1:ncol(x)){
x[,i]<-as.character(x[,i])
for(j in 1:row(x)){
if(is.na(x[j,i])==TRUE){
x[j,i]<-c(".")
}
}
}
return(head(x))
}
ds2<-NAhilator(ds)
ds2
warnings()
ds3[1:10, c(2, 19, 20)]
ds3<-[1:10, c(2, 19, 20)]
ds3<-ds[1:10, c(2, 19, 20)]
ds3
as.character(ds3)
as.character(ds3[,2])
ds3[,2]<-as.character(ds3[,2])
ds3
head(ds)
q<-sum(is.na(ds[,2]))
q
q<-as.character(ds[,2])
q
q1<-ifelse(is.na(q)==TRUE, c("."), q)
q1
NAhilator<-function(x){
for(i in 1:ncol(x)){
x[,i]<-as.character(x[,i])
for(j in 1:row(x)){
x[j,i]<-ifelse(is.na(x[j,i])==TRUE, c("."), x[j,i])
}
}
}
return(head(x))
}
NAhilator<-function(x){
for(i in 1:ncol(x)){
x[,i]<-as.character(x[,i])
for(j in 1:row(x)){
x[j,i]<-ifelse(is.na(x[j,i])==TRUE, c("."), x[j,i])
}
}
}
ds2<-NAhilator(ds)
warnings()
ds<-NAhilator(ds)
head(ds)
ds<-read.csv("S:/CCAN/CCANResEval/Title IV-E Waiver/DHS Data/kahd_72152_FY2012-FY2013/derived/joins_for_sas/aocs_client_removed-2014-11-16a.csv")
q<-as.character(ds[,2])
q
q1
ds<-data.frame(ds, stringsAsFactors=FALSE)
head(ds)
str(ds)
ds<-read.csv("S:/CCAN/CCANResEval/Title IV-E Waiver/DHS Data/kahd_72152_FY2012-FY2013/derived/joins_for_sas/aocs_client_removed-2014-11-16a.csv")
ds[,2]<-ifelse(is.na(ds[,2])==TRUE, c("."), ds[,2])
ds[,2]
ds[,2]<-ifelse(is.na(as.character(ds[,2]))==TRUE, c("."), ds[,2])
ds[,2]
ds<-read.csv("S:/CCAN/CCANResEval/Title IV-E Waiver/DHS Data/kahd_72152_FY2012-FY2013/derived/joins_for_sas/aocs_client_removed-2014-11-16a.csv")
ds[,2]
ds[,2]<-ifelse(is.na(as.character(ds[,2]))==TRUE, c("."), ds[,2])
ds[,2]
NAhilator<-function(x){
x=data.fram()
for(i in 1:ncol(x)){
ds[,i]<-ifelse(is.na(as.character(ds[,i]))==TRUE, c("."), ds[,i])
}
}
ds2<-NAhilator(ds)
NAhilator<-function(x){
for(i in 1:ncol(x)){
ds[,i]<-ifelse(is.na(as.character(ds[,i]))==TRUE, c("."), ds[,i])
}
}
ds2<-NAhilator(ds)
head(ds2)
ds<-read.csv("S:/CCAN/CCANResEval/Title IV-E Waiver/DHS Data/kahd_72152_FY2012-FY2013/derived/joins_for_sas/aocs_client_removed-2014-11-16a.csv")
NAhilator<-function(x){
for(i in 1:ncol(x)){
ds[,i]<-ifelse(is.na(as.character(ds[,i]))==TRUE, c("."), ds[,i])
}
x
}
ds2<-NAhilator(ds)
ds2<-function(ds)
)
ds2<-NAhilator(ds)
head(ds2)
for(i in 1:ncol(ds)){
ds[,i]<-as.character(ds[,i])
}
ds<-read.csv("S:/CCAN/CCANResEval/Title IV-E Waiver/DHS Data/kahd_72152_FY2012-FY2013/derived/joins_for_sas/aocs_client_removed-2014-11-16a.csv")
for(i in 1:ncol(ds)){
ds[,i]<-as.character(ds[,i])
}
str(ds)
for(i in 1:ncol(ds)){
ds[,i]<-ifelse(is.na(as.character(ds[,i]))==TRUE, c("."), ds[,i])
}
head(ds)
ds2<-NAHilator(ds)
NAHilator<-function(x){
for(i in 1:ncol(ds)){
ds[,i]<-as.character(ds[,i])
ds[,i]<-ifelse(is.na(as.character(ds[,i]))==TRUE, c("."), ds[,i])
}
NAHilator<-function(x){
for(i in 1:ncol(ds)){
ds[,i]<-as.character(ds[,i])
ds[,i]<-ifelse(is.na(as.character(ds[,i]))==TRUE, c("."), ds[,i])
}
}
}
NAHilator<-function(x){
for(i in 1:ncol(ds)){
ds[,i]<-as.character(ds[,i])
ds[,i]<-ifelse(is.na(as.character(ds[,i]))==TRUE, c("."), ds[,i])
}
}
ds2<-NAHilator(ds)
NAHilator<-function(x){
for(i in 1:ncol(x)){
x[,i]<-as.character(x[,i])
x[,i]<-ifelse(is.na(as.character(x[,i]))==TRUE, c("."), x[,i])
}
}
ds2<-NAHilator(ds)
ds2
NAHilator<-function(x){
for(i in 1:ncol(x)){
x[,i]<-as.character(x[,i])
x[,i]<-ifelse(is.na(as.character(x[,i]))==TRUE, c("."), x[,i])
}
return(x)
}
ds2<-NAHilator(ds)
ds2
head(ds2)
write.csv(ds2, file="NAhilator.r")
getwd()
write.csv(ds2, file="DHSWaiverdata-prepared for SAS Coxph.csv")
ds<-read.csv("S:/CCAN/CCANResEval/Title IV-E Waiver/DHS Data/kahd_72152_FY2012-FY2013/derived/joins_for_sas/aocs_client_removed-2014-11-16a.csv")
NAhilator<-function(x){
for(i in 1:ncol(x)){
x[,i]<-as.character(x[,i])
x[,i]<-ifelse(is.na(as.character(x[,i]))==TRUE, c("."), x[,i])
}
return(x)
}
ds2<-NAhilator(ds)
ds3<-ds2
ds3[,ds3$ReunificationWithin6Months]<-ifelse(ds3$ReunificationWithin6Months==TRUE, 1, 0)
ds3[,ds3$ReunificationWithin6Months]
break
escape
ds3$ReunificationWithin6Months<-ifelse(ds3$ReunificationWithin6Months==TRUE, 1, 0)
ds3$ReunificationWithin6Months
sum(ds$Reunificationwithin6Months)
length(ds$Reunificationwithin6Months)
ds$ReunificationWithin6Months
length(ds$Reunificationwithin6Months)
ncol(ds$Reunificationwithin6Months)
sum(ds$Reunificationwithin6Months)
ds3$ReunificationWithin6Months
ds$Reunificationwithin6Months
ds<-read.csv("S:/CCAN/CCANResEval/Title IV-E Waiver/DHS Data/kahd_72152_FY2012-FY2013/derived/joins_for_sas/aocs_client_removed-2014-11-16a.csv")
ds$Reunificationwithin6Months
length(ds$Reunificationwithin6Months)
ds3$ReunificationWithin6Months<-ifelse(ds3$ReunificationWithin6Months==c("TRUE"), 1, 0)
ds3$ReunificationWithin6Months
ds3$ReunificationWithin6Months<-ifelse(ds3$ReunificationWithin6Months==TRUE), 1, 0)
ds3$ReunificationWithin6Months<-ifelse(ds3$ReunificationWithin6Months==TRUE, 1, 0)
ds$Reunificationwithin6Months
names(ds)
length(ds[,47])
sum(ds[,47])
sum(is.na((ds[,47]))
)
sum(is.na(ds3[,47]))
ds3[,47]
ds3[,ds3$ReunificationWithin6Months]<-ifelse(ds3$ReunificationWithin6Months==TRUE, 1, 0)
ds3<-ds2
ds3[,ds3$ReunificationWithin6Months]<-ifelse(ds3$ReunificationWithin6Months==TRUE, 1, 0)
break
ds3$ReunificationWithin6Months<-ifelse(ds3$ReunificationWithin6Months==TRUE, 1, 0)
ds3$ReunificationWithin6Months
length(ds[,47])
sum(is.na((ds[,47])))
length(ds3[,47])
sum(is.na((ds3[,47])))
ds3[,47]
length(ds[,47])
sum(is.na((ds[,47])))
length(ds3[,47])
sum((ds3[,47]))
names(ds3)
ds2<-NAhilator(ds)
ds3<-ds2
ds3$ReunificationWithin6Months<-ifelse(ds3$ReunificationWithin6Months==TRUE, 1, 0)
head(ds3)
length(ds3[,47])
sum(ds3[,47])
sum(is.na((ds[,47])))
length(ds[,47])
sum(ds[,47])
str(ds[,47])
mean(ds[,47])
str(ds3[,47])
length(ds2[,47])
sum(ds2[,47])
length(ds3[,47])
sum(ds3[,47])
str(ds2[,47])
ds3$ReunificationWithin6Months<-ifelse(ds3$ReunificationWithin6Months==c("TRUE"), 1, 0)
sum(ds3[,47])
ds3<-ds2
ds3$ReunificationWithin6Months<-ifelse(ds3$ReunificationWithin6Months==c("TRUE"), 1, 0)
sum(ds3[,47])
length(ds2[,47])
sum(ds2[,47])
length(ds[,47])
sum(ds[,47])
ds<-read.csv("S:/CCAN/CCANResEval/Title IV-E Waiver/DHS Data/kahd_72152_FY2012-FY2013/derived/joins_for_sas/aocs_client_removed-2014-11-16a.csv")
library(survival)
library(foreign)
dsVets<- read.dta("http://www.sph.emory.edu/~dkleinb/surv2datasets/vets.dta")
Vets <- read.dta("http://web1.sph.emory.edu/dkleinb/allDatasets/surv2datasets/vets.dta")
CellCat2 <- ifelse((ct2) == 1, 2, ct2)
CellCat3 <- ifelse((ct3) == 1, 3, ct3)
CellCat4 <- ifelse((ct4) == 1, 4, ct4)
CellType <- ct1 + CellCat2 + CellCat3 + CellCat4
attach(Vets)
CellCat2 <- ifelse((ct2) == 1, 2, ct2)
CellCat3 <- ifelse((ct3) == 1, 3, ct3)
CellCat4 <- ifelse((ct4) == 1, 4, ct4)
CellType <- ct1 + CellCat2 + CellCat3 + CellCat4
levels(CellType) <- c("Large", "Adeno", "Small", "Squamous")
head(vets)
head(ets)
head(Vets)
Vets <- read.dta("http://web1.sph.emory.edu/dkleinb/allDatasets/surv2datasets/vets.dta")
head(Vets)
dsVets <- read.dta("http://web1.sph.emory.edu/dkleinb/allDatasets/surv2datasets/vets.dta")
head(dsVets)
names(dsVets)
names(dsVets)<-c("tx", "Large", "Adeno", "Small", "survt", "perf", "DisDur", "age", "priortx", "status")
head(dsVets)
names(dsVets)<-c("tx", "Large", "Adeno", "Small", "Squamous", "survt", "perf", "DisDur", "age", "priortx", "status")
head(dsVets)
coxphPractice1<coxph(Surv(Survt, status==1)~tx+Large+Adeno+Small+perf+DisDur+Age+priortx)
coxphPractice1<-coxph(Surv(Survt, status==1)~tx+Large+Adeno+Small+perf+DisDur+Age+priortx)
coxphPractice1<-coxph(Surv(survt, status==1)~tx+Large+Adeno+Small+perf+DisDur+Age+priortx)
coxphPractice1<-coxph(Surv(dsVets$survt, dsVets$status==1)~dsVets$tx+dsVets$Large+dsVets$Adeno+dsVets$Small+dsVets$perf+dsVets$DisDur+dsVets$Age+dsVets$priortx)
coxphPractice1<-coxph(Surv(dsVets$survt, dsVets$status==1)~dsVets$tx+dsVets$Large+dsVets$Adeno+dsVets$Small+dsVets$perf+dsVets$DisDur+dsVets$age+dsVets$priortx)
coxphPractice1
summary(coxphPractice1)
cox.zph(coxphPractice1)
?coxph()
coxphPractice1<-coxph(Surv(dsVets$survt, dsVets$status==1)~dsVets$tx+dsVets$Large+dsVets$Adeno+dsVets$Small+dsVets$perf+dsVets$DisDur+dsVets$age+dsVets$priortx, ties="Breslow")
coxphPractice1<-coxph(Surv(dsVets$survt, dsVets$status==1)~dsVets$tx+dsVets$Large+dsVets$Adeno+dsVets$Small+dsVets$perf+dsVets$DisDur+dsVets$age+dsVets$priortx, ties="breslow")
summary(coxphPractice1)
cox.zph(coxphPractice1)
coxphPractice1<-coxph(Surv(dsVets$survt, dsVets$status==1)~dsVets$tx+dsVets$Large+dsVets$Adeno+dsVets$Small+dsVets$perf+dsVets$DisDur+dsVets$age+dsVets$priortx, ties="efron")
summary(coxphPractice1)
cox.zph(coxphPractice1)
coxphPractice1<-coxph(Surv(dsVets$survt, dsVets$status==1)~dsVets$tx+dsVets$Large+dsVets$Adeno+dsVets$Small+dsVets$perf+dsVets$DisDur+dsVets$age+dsVets$priortx, ties="exact")
summary(coxphPractice1)
cox.zph(coxphPractice1)
coxphPractice1<-coxph(Surv(dsVets$survt, dsVets$status==1)~dsVets$tx+dsVets$Large+dsVets$Adeno+dsVets$Small+dsVets$perf+dsVets$DisDur+dsVets$age+dsVets$priortx, ties="breslow")
summary(coxphPractice1)
cox.zph(coxphPractice1)
head(dsVets)
?cox.zph()
cox.zph(coxphPractice1, transform="rank")
coxphPractice1<-coxph(Surv(dsVets$survt, dsVets$status==1)~dsVets$tx+dsVets$Large+dsVets$Adeno+dsVets$Small+dsVets$perf+dsVets$DisDur+dsVets$age+dsVets$priortx, ties="breslow")
cox.zph(coxphPractice1, transform="rank")
cox.zph(coxphPractice1, transform="identity")
cox.zph(coxphPractice1, transform="km")
length(dsVets)
nrow(dsVets)
head(dsVets)
test<-dsVets$Large + dsVets$Adeno + dsVets$Small + dsVets$Squamous
test
coxphPractice1
coxphPractice1
coxphPractice1<-coxph(Surv(dsVets$survt, dsVets$status==1)~dsVets$tx+dsVets$Large+dsVets$Adeno+dsVets$Small+dsVets$perf+dsVets$DisDur+dsVets$age+dsVets$priortx, ties="efron")
summary(coxphPractice1)
cox.zph(coxphPractice1, transform="km")
cox.zph(coxphPractice1, transform="rank")
cox.zph(coxphPractice1, transform="identity")
getwd()
setwd("~/GitHub/SurvivalExercises")
?write.csv()
write.csv(dsVets, file="Vets.csv", na=c("."), col.names=TRUE)
